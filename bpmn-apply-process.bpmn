<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL"
  id="Definitions_ApplyProcess" targetNamespace="http://example.com/bpmn">
  <bpmn:collaboration id="Collab_Apply">
    <bpmn:participant id="Participant_Applicant" name="Applicant" processRef="Process_Applicant"/>
    <bpmn:participant id="Participant_System" name="System" processRef="Process_System"/>
    <bpmn:participant id="Participant_Recruiter" name="Recruiter" processRef="Process_Recruiter"/>
    <bpmn:messageFlow id="MF1" name="ApplicationReceived" sourceRef="Task_CreateApplication" targetRef="Task_NotifyRecruiter"/>
    <bpmn:messageFlow id="MF2" name="EmailAck" sourceRef="Task_SendEmail" targetRef="Task_NotifyRecruiter"/>
  </bpmn:collaboration>

  <bpmn:process id="Process_Applicant" isExecutable="true">
    <bpmn:startEvent id="Start_Applicant" name="Tìm &amp; Xem Job"/>
    <bpmn:task id="Task_Login" name="Đăng nhập"/>
    <bpmn:task id="Task_UploadCV" name="Upload CV"/>
    <bpmn:boundaryEvent id="Boundary_UploadTimeout" attachedToRef="Task_UploadCV">
      <bpmn:timerEventDefinition/>
    </bpmn:boundaryEvent>
    <bpmn:task id="Task_Submit" name="Submit Application"/>
    <bpmn:endEvent id="End_Applicant" name="Đã nộp hồ sơ"/>

    <bpmn:sequenceFlow id="A1" sourceRef="Start_Applicant" targetRef="Task_Login"/>
    <bpmn:sequenceFlow id="A2" sourceRef="Task_Login" targetRef="Task_UploadCV"/>
    <bpmn:sequenceFlow id="A3" sourceRef="Task_UploadCV" targetRef="Task_Submit"/>
    <bpmn:sequenceFlow id="A4" sourceRef="Task_Submit" targetRef="End_Applicant"/>
    <bpmn:sequenceFlow id="A5" sourceRef="Boundary_UploadTimeout" targetRef="End_Applicant"/>
  </bpmn:process>

  <bpmn:process id="Process_System" isExecutable="true">
    <bpmn:startEvent id="Start_System" name="Receive Application"/>
    <bpmn:task id="Task_Validate" name="Validate JWT &amp; Job status"/>
    <bpmn:task id="Task_StoreCV" name="Store CV (private)"/>
    <bpmn:task id="Task_CreateApplication" name="Create Application (received)"/>
    <bpmn:task id="Task_Enqueue" name="Enqueue Mailer"/>
    <bpmn:endEvent id="End_System" name="Done"/>
    <bpmn:sequenceFlow id="S1" sourceRef="Start_System" targetRef="Task_Validate"/>
    <bpmn:sequenceFlow id="S2" sourceRef="Task_Validate" targetRef="Task_StoreCV"/>
    <bpmn:sequenceFlow id="S3" sourceRef="Task_StoreCV" targetRef="Task_CreateApplication"/>
    <bpmn:sequenceFlow id="S4" sourceRef="Task_CreateApplication" targetRef="Task_Enqueue"/>
    <bpmn:sequenceFlow id="S5" sourceRef="Task_Enqueue" targetRef="End_System"/>
  </bpmn:process>

  <bpmn:process id="Process_Recruiter" isExecutable="true">
    <bpmn:startEvent id="Start_Recruiter" name="Nhận thông báo"/>
    <bpmn:task id="Task_NotifyRecruiter" name="Email/Notification"/>
    <bpmn:task id="Task_Review" name="Review Application"/>
    <bpmn:exclusiveGateway id="GW_Decide" name="Decision"/>
    <bpmn:task id="Task_SendEmail" name="Gửi email kết quả"/>
    <bpmn:endEvent id="End_Recruiter" name="Hoàn tất"/>
    <bpmn:sequenceFlow id="R1" sourceRef="Start_Recruiter" targetRef="Task_NotifyRecruiter"/>
    <bpmn:sequenceFlow id="R2" sourceRef="Task_NotifyRecruiter" targetRef="Task_Review"/>
    <bpmn:sequenceFlow id="R3" sourceRef="Task_Review" targetRef="GW_Decide"/>
    <bpmn:sequenceFlow id="R4" sourceRef="GW_Decide" targetRef="Task_SendEmail"/>
    <bpmn:sequenceFlow id="R5" sourceRef="Task_SendEmail" targetRef="End_Recruiter"/>
  </bpmn:process>
</bpmn:definitions>
